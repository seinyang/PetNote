<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout" lang="kr">
<th:block layout:fragment="content">
<header id="main-header" class="py-2 bg-secondary text-white">
    <div class="container">
        <div class="row">
            <div class="col-md-6" align="center">
                <h1><i class="fas fa-lock-open"></i>로그인</h1>
            </div>
            <div class="col-md-6" align="center">
                <a href="/petnote" class="navbar-brand py-4 mb-4 pl-6 pr-6 text-white">
                    <i class="fa fa-home"></i>홈
                </a>
            </div>
        </div>
    </div>
</header>
<section id="actions" class="py-4 mb-4 bg-light">
    <div class="container">
        <div class="row"> </div>
    </div>
</section>
<section id="login">
    <div class="container">
        <div class="row">
            <div class="col-9 mx-auto">
                <div class="card">
                    <div class="card-header">
                        <h4>ID 로그인</h4>
                    </div>
                    <div class="card-body">
                        <form action="/MemberLogin" method="post" id="signupForm" enctype="application/x-www-form-urlencoded">
                            <fieldset>
                                <div class="form-group">

                                    <label for="id"><i class="fas fa-user-check mr-sm-1"></i>아이디</label>
                                    <input type="text" name="id" id="id" class="form-control" placeholder="아이디">
                                </div>
                                <div class="form-group">
                                    <label for="password"><i class="fas fa-user-lock mr-sm-1"></i>비밀번호</label>
                                    <input type="password" name="password" id="password" class="form-control" placeholder="비밀번호">
                                </div>
                                <div class="form-group">
                                    <div class="custom-control custom-checkbox">
                                        <input type="checkbox" name="save" class="custom-control-input" id="save">
                                        <label class="custom-control-label" for="save">로그인 상태 유지</label>
                                    </div>
                                </div>
                                <button type="submit" id="register" class="btn btn-info btn-block">
                                    로그인
                                </button>
                            </fieldset>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-9 mx-auto py-3 mb-3">
                <div>
                    <span>
                        <button type="button" class="btn btn-outline-success" onclick="window.location.href='/IdSearch'" >
                            <i class="fas fa-user-check mr-sm-1"></i>아이디 찾기
                        </button>
                    </span>
                    <span>
                        <button type="button" class="btn btn-outline-warning" onclick="location.href='/PasswordSearch'">
                            <i class="fas fa-user-lock mr-sm-1"></i>비밀번호 찾기
                        </button>
                    </span>
                    <span>
                        <button type="button" class="btn btn-outline-info" onclick="location.href='/MemberSignUp'">
                            <i class="fas fa-user-plus mr-sm-1"></i>회원 가입
                        </button>
                    </span>
                </div>
            </div>
        </div>
    </div>
    <script>
        function handleLogin(event) {
            event.preventDefault(); // 폼 제출 방지

            // 입력값 가져오기
            const id = document.getElementById('id').value;
            const password = document.getElementById('password').value;

            // 서버에 사용자 인증 요청
            $.ajax({
                url: '/MemberLogin',
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({ id: id, password: password }),
                success: function(response) {
                    if (response) {
                        alert("로그인 성공!");
                        window.location.href = "/petnote"; // 로그인 성공 시 홈 페이지로 이동
                    }
                },
                error: function() {
                    alert("가입되지 않은 아이디 또는 비밀번호입니다.");
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const form = document.getElementById('signupForm');
            form.addEventListener('submit', handleLogin);
        });
    </script>
</section>
</th:block>
</html>
